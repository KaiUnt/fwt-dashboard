name: Deploy to Production

on:
  push:
    branches: [master]

jobs:
  deploy:
    name: Deploy to Server
    runs-on: ubuntu-latest
    
    steps:
      - name: Deploy via SSH
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: report.kais.world
          username: kai
          key: ${{ secrets.SSH_PRIVATE_KEY }}
          # Pass SUDO_PASSWORD from step env into remote session and use it for sudo -S
          envs: SUDO_PASSWORD
          script: |
            echo "$SUDO_PASSWORD" | sudo -S /opt/fwt-dashboard/deploy.sh
        env:
          SUDO_PASSWORD: ${{ secrets.SUDO_PASSWORD }}
